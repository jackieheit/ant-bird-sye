---
title: "ant-bird"
format: html
date: "2024-02-04"
---

```{r}
library(tidyverse)
library(gridExtra)
library(knitr)
library(kableExtra)
library(mosaic)
library(xtable)
library(pscl) 
library(multcomp)
library(pander)
library(MASS)
```
info abt variables: 
- species: species of bird
- duration: how long it took
- attempts: the number of attempts to get food
- Rinter (receiving aggression from same species)
- Rintra (receiving aggression from different species)
- linter (same species initiating aggression)
- lintra (different species initiating aggression)
- successes: successfully caught food

```{r}
bird <- read_csv("data/ForgBout_00_01_07_08.csv")
```
# Data Exploration
```{r}
head(bird, 100)

bird %>%
  mutate(
    
  )
```




```{r}
# correlation matrix of predictors in relation to response
cor(bird[c("Successes", "attempts", "Rinter", "Rintra", "Iinter", "Iintra")])
```
# Poisson Regression
Assumptions:
1. Poisson Response The response variable is a count per unit of time or space, described by a Poisson distribution.
2. Independence The observations must be independent of one another.
3. Mean=Variance By definition, the mean of a Poisson random variable must be equal to its variance.
4. Linearity The log of the mean rate, log(Î»), must be a linear function of x.

# Possible Models
1. Poisson
2. Quassi-Poisson


Look at spread of data:
```{r}
# distribution of successes
ggplot(bird, aes(x = Successes)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black") +
  labs(title = "Distribution of Successes", x = "Number of Successes", y = "Frequency")

ggplot(bird, aes(x = attempts)) +
  geom_histogram(binwidth = 1, fill = "purple", color = "black") +
  labs(title = "Distribution of Attempts", x = "Number of Attempts", y = "Frequency")
```
* Quick summary tables of counts between predictors (Rinter, Rintra, Iinter, Iintra):
- sketch out what it might look like then code


```{r}
# relationship between attempts and successes
ggplot(bird, aes(x = attempts, y = Successes)) +
  geom_point() +
  labs(title = "Relationship between Attempts and Successes", x = "Number of Attempts", y = "Number of Successes")
```

```{r}
# create null model
# mod0 <- glm(Successes ~ 1, family = poisson, data = bird)

moda <- glm(Successes ~ attempts, family = poisson, data = bird)

# drop_in_dec <- anova(mod0, moda, test = "Chisq")

anova(moda, test = "Chisq")
```

```{r}
# poisson regression
poisson_model <- glm(Successes ~ attempts + Rinter + Rintra + Iinter + Iintra, data = bird, family = "poisson")
summary(poisson_model)
```

In order to create a binomial model, i need to make a binary or ratio type response variable. 
```{r}
# Fit a binomial regression model (assuming binary outcomes)
binomial_model <- glm(Successes / attempts ~ Rinter + Rintra + Iinter + Iintra, data = bird, family = "binomial")
summary(binomial_model)
```

